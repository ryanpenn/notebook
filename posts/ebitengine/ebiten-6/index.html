<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.147.7"><meta name=viewport content="width=device-width,initial-scale=1"><title>[Ebitengine] (六) 使用Ebiten-UI &#183; Notebook</title><meta name=description content><link type=text/css rel=stylesheet href=https://ryanpenn.github.io/notebook/css/print.css media=print><link type=text/css rel=stylesheet href=https://ryanpenn.github.io/notebook/css/poole.css><link type=text/css rel=stylesheet href=https://ryanpenn.github.io/notebook/css/syntax.css><link type=text/css rel=stylesheet href=https://ryanpenn.github.io/notebook/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body class=theme-base-0d><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://ryanpenn.github.io/notebook/><h1>Notebook</h1></a><p class=lead>My notes on development and other things.</p></div><nav><ul class=sidebar-nav><li><a href=https://ryanpenn.github.io/notebook/>Home</a></li><li><a href=/notebook/posts/>Posts</a></li><li><a href=/notebook/tags/>Tags</a></li><li><a href=https://github.com/ryanpenn/>Github</a></li></ul></nav><p>&copy; 2025. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>[Ebitengine] (六) 使用Ebiten-UI</h1><time datetime=2025-02-20T09:31:39+0800 class=post-date>Thu, Feb 20, 2025</time><h2 id=核心概念>核心概念</h2><p><code>Ebiten UI</code> 是一款基于 Ebiten 引擎的复杂且灵活的用户界面引擎。本页介绍了其中使用的概念。</p><h2 id=保留模式>保留模式</h2><p>Ebiten UI 采用 <a href=https://en.wikipedia.org/wiki/Retained_mode>保留模式(Retained Mode)</a> 模型来处理用户界面。这意味着对 Ebiten UI API 的调用（例如构造按钮）不会导致实际渲染。构造 UI 小部件是相当声明性的：UI 被构造为包含许多容器、小部件和布局，并且 Ebiten UI 本身会在适当的时候引发实际渲染调用。</p><h2 id=小部件widget层次结构>小部件(Widget)层次结构</h2><p>整个用户界面在 Ebiten UI 中构建为层次结构：</p><ul><li>顶层是<strong>UI类型</strong>。它主要包含对根容器的引用，以及对工具提示渲染器、拖放渲染器和任何浮动窗口的引用。UI 用于渲染整个用户界面。它还负责在整个用户界面中传递事件。</li><li><strong>容器</strong>是将事物组合在一起的主要类型，例如一行按钮。容器可以包含任意数量的小部件以及其他容器。它们负责布局其子小部件。</li><li>在最低级别，有诸如按钮或复选框之类的<strong>小部件</strong>。</li></ul><h2 id=小部件>小部件</h2><p>Widget类型在 Ebiten UI 中很特殊：由于 Go 仅使用组合而不是继承，因此每个小部件实现（例如按钮）都“有”一个 Widget。Widget 类型负责处理基本的小部件任务，例如记住位置，或触发光标进入/退出和点击事件。如果需要，它还包含小部件的布局数据（见下文）。</p><h2 id=布局>布局</h2><p>在 Ebiten UI 中，通常不会手动布局小部件。相反，它们会作为子小部件组合到容器中，然后由容器的布局器负责布局小部件。</p><p>Ebiten UI 中有几个 Layouter 实现：</p><ul><li><code>AnchorLayout</code> 只能定位一个 widget，它会将其锚定到容器的一角或边缘。它可以选择性地沿任意方向拉伸 widget。</li><li><code>GridLayout</code> 可以在网格中布局任意数量的小部件。它可以为每个网格单元定位不同的小部件，也可以拉伸它们。</li><li><code>RowLayout</code> 可在一行或一列中布置任意数量的小部件。它还可以以不同方式定位小部件，并根据需要拉伸它们。</li></ul><h2 id=九宫格>九宫格</h2><p>虽然 Ebiten 使用基本图像类型将图像绘制到屏幕上，但这对于许多小部件来说还不够。例如，按钮的图像需要根据按钮的文本进行拉伸或收缩，而不会扭曲图像。为此，Ebiten UI 采用了九宫缩放技术。</p><p><code>NineSlice</code> 基本上是一个 3x3 的图像块网格：角块按原样绘制，而边缘块和中心块则被拉伸：</p><p><img src=https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Traditional_scaling_vs_9-slice_scaling.svg/320px-Traditional_scaling_vs_9-slice_scaling.svg.png alt=NineSlice></p><blockquote><p>上图：传统缩放，角落扭曲。下图：9 片缩放，角落未扭曲。（图片：维基百科）</p></blockquote><h2 id=选项>选项</h2><p>在构建小部件或布局器时，它们中的大多数都支持许多选项来配置其渲染或行为。例如，按钮具有用于配置用于渲染的实际图像、按钮的文本、字体、文本颜色、填充等的选项。</p><p>举个例子，一个按钮可以像这样构造：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>button</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(
</span></span><span style=display:flex><span>  <span style=color:#75715e>// specify the images to use</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>ButtonOpts</span>.<span style=color:#a6e22e>Image</span>(<span style=color:#a6e22e>buttonImage</span>),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// specify the button&#39;s text, the font face, and the color</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>ButtonOpts</span>.<span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#34;Hello, World!&#34;</span>, <span style=color:#a6e22e>face</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>ButtonTextColor</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Idle</span>: <span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>RGBA</span>{<span style=color:#ae81ff>0xdf</span>, <span style=color:#ae81ff>0xf4</span>, <span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xff</span>},
</span></span><span style=display:flex><span>  }),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// specify that the button&#39;s text needs some padding for correct display</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>ButtonOpts</span>.<span style=color:#a6e22e>TextPadding</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>Insets</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Left</span>:  <span style=color:#ae81ff>30</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Right</span>: <span style=color:#ae81ff>30</span>,
</span></span><span style=display:flex><span>  }),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ... click handler, etc. ...</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>有些选项对于每个小部件实现都是相同的，例如指定布局数据。在这种情况下，这些选项允许指定小部件选项：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>button</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ... other button options ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// set general widget options</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>ButtonOpts</span>.<span style=color:#a6e22e>WidgetOpts</span>(
</span></span><span style=display:flex><span>    <span style=color:#75715e>// instruct the container&#39;s anchor layout to center the button</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// both horizontally and vertically</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>WidgetOpts</span>.<span style=color:#a6e22e>LayoutData</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>AnchorLayoutData</span>{
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>HorizontalPosition</span>: <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>AnchorLayoutPositionCenter</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>VerticalPosition</span>:   <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>AnchorLayoutPositionCenter</span>,
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>  ),
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>根据小部件的实现，某些选项是必须指定的（例如按钮的图像），而其他选项则是可选的。选项的顺序通常无关紧要。某些选项可能会指定多次。</p></div></main></body></html>